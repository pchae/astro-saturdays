---
import DashboardLayout from "../layouts/Dashboard.astro";
import { SettingsTabs } from "../components/settings/SettingsTabs";
import { checkAuth } from "../lib/auth";

// Check authentication
export const prerender = false;
const authResult = await checkAuth(Astro);
if (authResult.redirect) return authResult.redirect;

// Get user data for layout
const user = authResult.session?.data?.user;
if (!user) {
  return Astro.redirect("/signin");
}

// Get the active tab from URL hash or default to 'profile'
const hash = Astro.url.hash.slice(1) || 'profile';
---

<DashboardLayout title="Settings - Saturdays.io" email={user.email} user={user}>
  <div class="container py-10">
    <h1 class="text-3xl font-bold mb-8">Account Settings</h1>
    <SettingsTabs client:load defaultTab={hash} />
  </div>
</DashboardLayout>
